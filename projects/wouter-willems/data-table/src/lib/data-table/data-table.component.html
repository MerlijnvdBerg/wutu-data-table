<wutu-lib-style></wutu-lib-style>

<div class="topButtons">
	<select [(ngModel)]="itemsPerPage">
		<option value="1">1</option>
		<option value="3">3</option>
		<option value="5">5</option>
		<option value="10">10</option>
	</select>
	<div>
		<ng-container [ngTemplateOutlet]="configBtnRef" [ngTemplateOutletContext]="{clickHandler: openConfig}"></ng-container>
	</div>
</div>
<table>
	<thead>
	<tr>
		<td (click)="headerSelectClicked()">
			<div class="selectBox">
				<ng-container [ngTemplateOutlet]="checkboxRef" [ngTemplateOutletContext]="{isSelected: getHeaderSelectState()}"></ng-container>
			</div>
		</td>
		<td *ngFor="let header of headers">
			{{header}}
		</td>
		<td></td>
	</tr>
	</thead>
	<tbody>
	<tr *ngFor="let row of stuff?.data">
		<td (click)="rowSelectClicked(row)">
			<div class="selectBox">
				<ng-container [ngTemplateOutlet]="checkboxRef" [ngTemplateOutletContext]="{isSelected: isSelected(row)}"></ng-container>
			</div>
		</td>
		<td *ngFor="let header of headerKeys" (click)="rowClicked(row)">
			<ng-container
				[ngTemplateOutlet]="getTemplate(header, row[header])"
				[ngTemplateOutletContext]="{ value: row[header] }"
			></ng-container>
		</td>
		<td>
			<div class="actionMenuContainer">
				<button (click)="showActions(row)">...</button>
				<div class="actionMenu" *ngIf="actionMenuActionForRow === row">
					<button *ngFor="let action of actions" (click)="action.action()">
						{{action.caption}}
					</button>
				</div>
			</div>
		</td>
	</tr>
	</tbody>
</table>

<div class="pageNumbers" *ngIf="stuff">
	<button (click)="toPage(1)">First</button>
	<button (click)="toPage(currentPage-1)" [disabled]="currentPage === 1">Previous</button>
	<button class="pageNrButton" *ngFor="let pageNr of getPageNumbers()" (click)="toPage(pageNr)" [ngClass]="{selected: currentPage === pageNr}">
		<span>{{pageNr}}</span>
	</button>
	<button (click)="toPage(currentPage+1)" [disabled]="currentPage === this.getLastPage()">Next</button>
	<button (click)="toPage(this.getLastPage())">Last</button>
</div>

{{definedColumns | json}}

<div class="columnRearranger" *ngIf="showConfig">
	<button class="closeButton" (click)="closeConfig()">X</button>
	<wutu-column-rearranger [(ngModel)]="definedColumns" (onCloseRequest)="closeConfig()" (onColumnsSaved)="extractHeaders()"></wutu-column-rearranger>
</div>
